# SK42mapper

Приложение для создания топографических карт со спутниковыми снимками и километровой сеткой в системе координат СК-42 / Гаусса–Крюгера.

## Возможности

- **GUI-интерфейс** на PySide6 с профилями конфигурации
- **Загрузка спутниковых тайлов** из Mapbox API (асинхронно через aiohttp с кэшированием)
- **Километровая сетка СК-42/ГК** (EPSG:284xx) с подписями координат
- **Контурные линии рельефа** (изогипсы) на основе данных высот Mapbox Terrain-RGB
- **Поворот карты** для выравнивания сетки по сторонам света
- **Настраиваемые параметры Гельмерта** для точного преобразования WGS84↔СК-42
- **Коррекция изображения**: яркость, контраст, насыщенность, маска прозрачности
- **Контрольные точки** для проверки точности позиционирования

## Требования

- Python 3.13
- Ключ Mapbox API (access token)

## Установка

### С помощью Poetry (рекомендуется)

```bash
poetry install
```

### Конфигурация API-ключа

Создайте файл `.env` или `.secrets.env` в корне проекта:

```
API_KEY=ваш_mapbox_access_token
```

Или задайте переменную окружения `API_KEY`.

## Запуск

```bash
poetry run python src/main.py
```

Или из активированного виртуального окружения:

```bash
python src/main.py
```

## Профили конфигурации

Профили хранятся в `configs/profiles/` в формате TOML и содержат:

- Координаты области в СК-42/ГК
- Тип карты (SATELLITE и др.)
- Настройки сетки и шрифтов
- Параметры преобразования Гельмерта
- Параметры обработки изображения

При первом запуске профили копируются в `%APPDATA%/SK42mapper/configs/profiles/`.

## Данные приложения

- **Профили и карты**: `%APPDATA%/SK42mapper/`
- **Кэш тайлов**: `%LOCALAPPDATA%/SK42mapper/.cache/tiles/`
- **Логи**: `%LOCALAPPDATA%/SK42mapper/log/`

## Ограничения

- Точность преобразования СК-42↔WGS84 зависит от заданных параметров Гельмерта
- Mapbox API имеет квоты и лимиты запросов

## Лицензия

Используйте на свой страх и риск с соблюдением условий используемых сервисов.
